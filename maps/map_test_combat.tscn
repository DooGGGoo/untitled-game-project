[gd_scene load_steps=16 format=3 uid="uid://gji1allj60r0"]

[ext_resource type="Script" path="res://entities/level/Level.cs" id="1_akk1m"]
[ext_resource type="Texture2D" uid="uid://bd2datw4a75dw" path="res://assets/materials/textures/dev_1.png" id="2_0meno"]
[ext_resource type="Script" path="res://addons/proto_shape/proto_ramp/proto_ramp.gd" id="2_coiv3"]
[ext_resource type="Script" path="res://entities/level/LevelObjective.cs" id="3_01t01"]
[ext_resource type="Material" uid="uid://bg66ey6w10il2" path="res://assets/materials/dev_1.tres" id="3_tyfxl"]
[ext_resource type="PackedScene" uid="uid://clmdui4kep3fn" path="res://entities/tests/button_test.tscn" id="4_gnt1e"]
[ext_resource type="Script" path="res://entities/level/Indicator.cs" id="5_1vb38"]
[ext_resource type="Script" path="res://entities/level/LevelExtractionArea.cs" id="6_8cq51"]

[sub_resource type="PanoramaSkyMaterial" id="PanoramaSkyMaterial_s5ha2"]
panorama = ExtResource("2_0meno")
filter = false

[sub_resource type="Sky" id="Sky_r63i6"]
sky_material = SubResource("PanoramaSkyMaterial_s5ha2")

[sub_resource type="Environment" id="Environment_4v4q0"]
background_mode = 2
background_energy_multiplier = 0.65
sky = SubResource("Sky_r63i6")
ambient_light_sky_contribution = 0.3
tonemap_mode = 2
tonemap_exposure = 0.9
tonemap_white = 1.15
ssao_enabled = true
ssao_radius = 0.75
ssao_intensity = 2.9
ssao_power = 2.35375
ssao_detail = 1.05
glow_enabled = true
glow_normalized = true
glow_intensity = 0.1
glow_strength = 0.93
glow_bloom = 0.01
glow_blend_mode = 0
fog_enabled = true
fog_light_color = Color(0.511355, 0.502337, 0.511351, 1)
fog_sun_scatter = 0.25
fog_aerial_perspective = 0.785
volumetric_fog_enabled = true
volumetric_fog_anisotropy = 0.27
volumetric_fog_length = 39.66
volumetric_fog_detail_spread = 1.68179
volumetric_fog_sky_affect = 0.575

[sub_resource type="BoxMesh" id="BoxMesh_2yk7n"]
size = Vector3(0.25, 0.25, 0.25)

[sub_resource type="BoxShape3D" id="BoxShape3D_x8bol"]
size = Vector3(3, 2, 2)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_f0vs8"]
transparency = 1
cull_mode = 2
shading_mode = 0
albedo_color = Color(0.772549, 0.772549, 0, 0.301961)

[sub_resource type="BoxMesh" id="BoxMesh_3cb7c"]
material = SubResource("StandardMaterial3D_f0vs8")
size = Vector3(3, 2, 2)

[node name="MapTestCombat" type="Node" node_paths=PackedStringArray("PlayerSpawn")]
script = ExtResource("1_akk1m")
PlayerSpawn = [NodePath("Map/Spawn")]

[node name="Environment" type="Node" parent="."]

[node name="WorldEnvironment" type="WorldEnvironment" parent="Environment"]
environment = SubResource("Environment_4v4q0")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="Environment"]
transform = Transform3D(-0.559348, -0.532388, 0.635369, -0.00256157, 0.767596, 0.640928, -0.828929, 0.356874, -0.430717, 0, 0, 0)
light_energy = 0.56
light_bake_mode = 1
shadow_enabled = true
directional_shadow_mode = 0
directional_shadow_split_1 = 0.165
directional_shadow_max_distance = 14.8

[node name="SpotLight3D" type="SpotLight3D" parent="Environment"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 2.2, 8.4)
spot_range = 4.83676
spot_attenuation = 0.133972
spot_angle = 50.0802
spot_angle_attenuation = 0.435275

[node name="SpotLight3D2" type="SpotLight3D" parent="Environment"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, -3.5, 2.2, 12)
spot_range = 4.83676
spot_attenuation = 0.133972
spot_angle = 50.0802
spot_angle_attenuation = 0.435275

[node name="SpotLight3D3" type="SpotLight3D" parent="Environment"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 3.5, 2.2, 12)
spot_range = 4.83676
spot_attenuation = 0.133972
spot_angle = 50.0802
spot_angle_attenuation = 0.435275

[node name="SpotLight3D4" type="SpotLight3D" parent="Environment"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 4.5, 31.5)
spot_range = 4.83676
spot_attenuation = 0.133972
spot_angle = 50.0802
spot_angle_attenuation = 0.435275

[node name="Map" type="Node" parent="."]

[node name="CSGCombiner3D" type="CSGCombiner3D" parent="Map"]
use_collision = true

[node name="CSGBox3D" type="CSGBox3D" parent="Map/CSGCombiner3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.3, 3.5)
size = Vector3(2, 0.5, 9)
material = ExtResource("3_tyfxl")

[node name="CSGBox3D2" type="CSGBox3D" parent="Map/CSGCombiner3D"]
transform = Transform3D(-4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, 0.0999999, -0.3, 9)
size = Vector3(2, 0.5, 9)
material = ExtResource("3_tyfxl")

[node name="CSGBox3D3" type="CSGBox3D" parent="Map/CSGCombiner3D"]
transform = Transform3D(-1, 0, 8.74228e-08, 0, 1, 0, -8.74228e-08, 0, -1, 3.6, -0.3, 12.75)
size = Vector3(2, 0.5, 5.5)
material = ExtResource("3_tyfxl")

[node name="CSGBox3D4" type="CSGBox3D" parent="Map/CSGCombiner3D"]
transform = Transform3D(-1, 0, 8.74228e-08, 0, 1, 0, -8.74228e-08, 0, -1, -3.4, -0.3, 12.75)
size = Vector3(2, 0.5, 5.5)
material = ExtResource("3_tyfxl")

[node name="CSGBox3D5" type="CSGBox3D" parent="Map/CSGCombiner3D"]
transform = Transform3D(-4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, 0.0999999, -0.3, 16.5)
size = Vector3(2, 0.5, 9)
material = ExtResource("3_tyfxl")

[node name="CSGBox3D6" type="CSGBox3D" parent="Map/CSGCombiner3D"]
transform = Transform3D(-1, 0, 8.74228e-08, 0, 1, 0, -8.74228e-08, 0, -1, 0.1, -0.3, 20.75)
size = Vector3(2, 0.5, 6.5)
material = ExtResource("3_tyfxl")

[node name="ProtoRamp" type="CSGCombiner3D" parent="Map/CSGCombiner3D/CSGBox3D6"]
transform = Transform3D(-1, 0, 8.74228e-08, 0, 1, 0, -8.74228e-08, 0, -1, 7.45058e-09, 0.2, -3.2)
material_override = ExtResource("3_tyfxl")
material_overlay = ExtResource("3_tyfxl")
script = ExtResource("2_coiv3")
type = 1
width = 2.001
height = 2.001
depth = 3.0019
anchor = 0
anchor_fixed = true
calculation = 0
steps = 12
fill = true

[node name="CSGBox3D7" type="CSGBox3D" parent="Map/CSGCombiner3D"]
transform = Transform3D(-1, 0, 8.74228e-08, 0, 1, 0, -8.74228e-08, 0, -1, 0.1, 1.7, 29.95)
size = Vector3(2, 0.5, 6.5)
material = ExtResource("3_tyfxl")

[node name="Spawn" type="Marker3D" parent="Map"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.1, 0)

[node name="LevelObjective" type="Node" parent="Map"]
script = ExtResource("3_01t01")

[node name="Button" parent="Map/LevelObjective" instance=ExtResource("4_gnt1e")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 4.4, 0.2, 12)

[node name="Indicator" type="Node3D" parent="Map/LevelObjective"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 4.4, 0.7, 12)
script = ExtResource("5_1vb38")

[node name="MeshInstance3D" type="MeshInstance3D" parent="Map/LevelObjective/Indicator"]
mesh = SubResource("BoxMesh_2yk7n")

[node name="LevelObjective2" type="Node" parent="Map"]
script = ExtResource("3_01t01")

[node name="Button" parent="Map/LevelObjective2" instance=ExtResource("4_gnt1e")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4.2, 0.2, 12)

[node name="Indicator" type="Node3D" parent="Map/LevelObjective2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4.2, 0.7, 12)
script = ExtResource("5_1vb38")

[node name="MeshInstance3D" type="MeshInstance3D" parent="Map/LevelObjective2/Indicator"]
mesh = SubResource("BoxMesh_2yk7n")

[node name="LevelExtractionArea" type="Area3D" parent="Map"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 3.1, 32)
script = ExtResource("6_8cq51")
neededObjectives = 2

[node name="CollisionShape3D" type="CollisionShape3D" parent="Map/LevelExtractionArea"]
shape = SubResource("BoxShape3D_x8bol")

[node name="MeshInstance3D" type="MeshInstance3D" parent="Map/LevelExtractionArea/CollisionShape3D"]
mesh = SubResource("BoxMesh_3cb7c")

[connection signal="ObjectiveCompleted" from="Map/LevelObjective" to="Map/LevelObjective/Indicator" method="ChangeColor"]
[connection signal="ObjectiveCompleted" from="Map/LevelObjective" to="Map/LevelExtractionArea" method="OnObjectiveCompleted"]
[connection signal="ButtonPressed" from="Map/LevelObjective/Button" to="Map/LevelObjective" method="CompleteObjective"]
[connection signal="ObjectiveCompleted" from="Map/LevelObjective2" to="Map/LevelObjective2/Indicator" method="ChangeColor"]
[connection signal="ObjectiveCompleted" from="Map/LevelObjective2" to="Map/LevelExtractionArea" method="OnObjectiveCompleted"]
[connection signal="ButtonPressed" from="Map/LevelObjective2/Button" to="Map/LevelObjective2" method="CompleteObjective"]
[connection signal="ExtractFromLevel" from="Map/LevelExtractionArea" to="." method="ReturnToBase"]
